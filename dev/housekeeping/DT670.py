# Dominik Gothe
# gothed [magic email symbol] pha.jhu.edu
# Python 2.7

import array

#	This function implments the DT670 standard curve.
# It converts a voltage into a temperature.
# See the DT670 standard curve for mathematical impimentation
def DT670(Z):
  ZL = 0
  ZU = 0
  A = array.array('d', [0.0]*12)
  
  if (Z > 1.334990) :
    ZL   = 1.294390
    ZU   = 1.680000
    A[0] = 6.429274
    A[1] =-7.514262
    A[2] =-0.725882
    A[3] =-1.117846
    A[4] =-0.562041
    A[5] =-0.360239
    A[6] =-0.229751
    A[7] =-0.135713
    A[8] =-0.068203
    A[9] =-0.029755
    A[10]= 0.000000
    A[11]= 0.000000
 
  elif (Z > 1.125923) :
    ZL   =  1.112300
    ZU   =  1.383730
    A[0] = 17.244846
    A[1] = -7.964373
    A[2] =  0.625343
    A[3] = -0.105068
    A[4] =  0.292196
    A[5] = -0.344492
    A[6] =  0.271670
    A[7] = -0.151722
    A[8] =  0.121320
    A[9] = -0.035566
    A[10]=  0.045966
    A[11]=  0.000000
    
  elif(Z > .986974) :
    ZL   =   .909416
    ZU   =  1.122751
    A[0] = 82.017868
    A[1] =-59.064244
    A[2] = -1.356615
    A[3] =  1.055396
    A[4] =  0.837341
    A[5] =  0.431875
    A[6] =  0.440840
    A[7] = -0.061588
    A[8] =  0.209414
    A[9] = -0.120882
    A[10]=  0.055734
    A[11]= -0.035974
  
  elif(Z <= .986974) :
    ZL   = .07000
    ZU   = .99799
    A[0] = 306.592351
    A[1] =-205.393808
    A[2] =-4.695680
    A[3] =-2.031603
    A[4] =-0.071792
    A[5] =-0.437682
    A[6] = 0.176352
    A[7] =-0.182516
    A[8] = 0.064687
    A[9] =-0.027019
    A[10]= 0.010019
    A[11]= 0.000000
  
  X = ((Z-ZL)-(ZU-Z))/(ZU-ZL)
  Tc = array.array('d', [0.0]*12)
  T = 0
  Tc[0] = 1
  Tc[1] = X
  T=A[0]+A[1]*X
  
  for i in range (2, len(A))  :
    Tc[i] = 2*X*Tc[i-1]-Tc[i-2]
    T+=A[i]*Tc[i]
  return T
